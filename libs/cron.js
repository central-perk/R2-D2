// Generated by CoffeeScript 1.7.1
var CronJob, config, delay3s, logFile, path, request, storage, store, utils;

path = require('path');

CronJob = require('cron').CronJob;

request = require('request');

config = process.g.config;

utils = process.g.utils;

storage = utils.getCtrl('storage');

logFile = utils.getCtrl('log');

delay3s = ((new Date()).getSeconds() + 3) % 60;

if (config.STORAGE.cron) {
  store = new CronJob(config.STORAGE.cron, function() {
    return logFile.readyStorage(function(err) {
      if (!err) {
        return storage.start();
      } else {
        return console.log(err);
      }
    });
  }, null, true, 'Asia/Shanghai');
}
