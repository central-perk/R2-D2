// Generated by CoffeeScript 1.7.1
var async, config, dbHost, exec, fs, mongoose, path, utils;

path = require('path');

exec = require('child_process').exec;

async = require('async');

fs = require('fs-extra');

mongoose = require('mongoose');

config = process.g.config;

utils = process.g.utils;

dbHost = "mongodb://" + config.DB.host + ":" + config.DB.port + "/" + config.DB.name;

module.exports = {
  connect: function(callback) {
    var db;
    db = mongoose.connect(dbHost);
    mongoose.connection.on('close', function(str) {
      return console.err("DB disconnected: " + str);
    });
    return mongoose.connection.once('open', function() {
      console.log('DB connected %s', dbHost);
      return callback(mongoose);
    });
  },
  drop: function(callback) {
    return this.connect(function(mongoose) {
      return mongoose.connection.db.dropDatabase(function() {
        console.log('DB', dbHost, 'droped');
        return callback(mongoose);
      });
    });
  }
};
