// Generated by CoffeeScript 1.7.1
var DB_CONFIG, async, config, dbHost, filePath, fs, mongoose, path, utils;

path = require('path');

fs = require('fs-extra');

async = require('async');

mongoose = require('mongoose');

config = process.g.config;

utils = process.g.utils;

filePath = process.g.path;

DB_CONFIG = config.APP.DB;

dbHost = "mongodb://" + DB_CONFIG.host + ":" + DB_CONFIG.port + "/" + DB_CONFIG.name + "_" + process.env.NODE_ENV;

module.exports = {
  connect: function(callback) {
    var db;
    db = mongoose.connect(dbHost);
    mongoose.connection.on('close', function(str) {
      return console.err("DB disconnected: " + str);
    });
    return mongoose.connection.once('open', function() {
      console.log('DB connected %s', dbHost);
      return callback(mongoose);
    });
  },
  drop: function(callback) {
    return this.connect(function(mongoose) {
      return mongoose.connection.db.dropDatabase(function() {
        console.log('DB', dbHost, 'droped');
        return callback(mongoose);
      });
    });
  }
};
